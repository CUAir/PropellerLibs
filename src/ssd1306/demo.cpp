#include <propeller.h>

#include "global.h"
#include "ssd1306.h"

I2CBus i2cbus(p_I2C_SCL, p_I2C_SDA);
SSD1306 oled(&i2cbus, SSD1306_ADDR, p_SSD1306_RST, 15);

static uint8_t logo_bmp[] = { 
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0e,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1f,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1e,0x00,0x00,0x00,0x00,0x07,0xc0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x7f,0xf8,0x00,0x3e,0x00,0x00,0x00,0x00,0x07,0x80,0x00,0x00,
	0x00,0x00,0x00,0x1f,0xff,0xfc,0x00,0x7e,0x00,0x00,0x00,0x00,0x0f,0x80,0x00,0x00,
	0x00,0x00,0x03,0xff,0xff,0xfc,0x00,0x7c,0x00,0x00,0x00,0x00,0x0f,0x00,0x00,0x00,
	0x00,0x00,0x1f,0xff,0x81,0xfc,0x00,0xf0,0x00,0x00,0x00,0x00,0x1f,0x00,0x00,0x00,
	0x00,0x00,0x3f,0xe0,0x07,0xf8,0x00,0xe0,0x00,0x00,0x00,0x00,0x1e,0x00,0x00,0x00,
	0x00,0x00,0x3f,0xc0,0x0f,0xf1,0xc0,0xe0,0x00,0x10,0xc0,0x07,0xbe,0x60,0x00,0x00,
	0x00,0x00,0x07,0x80,0x3f,0xe7,0xe1,0xe0,0x03,0x39,0xe0,0x1f,0xbf,0xe0,0x00,0x00,
	0x00,0x00,0x0f,0x80,0x7f,0xcf,0xe1,0xc1,0xc7,0x3b,0xf0,0x7f,0xff,0xc0,0x00,0x00,
	0x00,0x00,0x0f,0x01,0xff,0x3e,0xe3,0xc1,0xc7,0x7b,0xf0,0xff,0xfc,0x00,0x00,0x00,
	0x00,0x00,0x0f,0x03,0xfc,0x3f,0xc7,0xfb,0xcf,0x7f,0xf1,0xff,0xf8,0x00,0x00,0x00,
	0x00,0x00,0x1f,0x0f,0xf0,0x7f,0x9f,0xf3,0xde,0x7f,0xe7,0xe6,0x70,0x00,0x00,0x00,
	0x00,0x00,0x1e,0x1f,0xc0,0xfe,0x7f,0x87,0xbe,0xff,0xef,0xc0,0xf0,0x00,0x00,0x00,
	0x00,0x00,0x1e,0x7f,0x81,0xe1,0xff,0x07,0xfe,0xfc,0xef,0x01,0xe0,0x00,0x00,0x00,
	0x00,0x00,0x1c,0xfc,0x01,0xc7,0xce,0x07,0xfc,0xfc,0xfe,0x0f,0xe0,0x00,0x00,0x00,
	0x00,0x00,0x1f,0xf8,0x01,0xff,0x8e,0x0f,0xfc,0xf8,0xde,0x7d,0xe0,0x00,0x00,0x00,
	0x00,0x00,0x0f,0xe0,0x00,0xff,0x1c,0x0f,0xdd,0xf0,0xdf,0xf9,0xc0,0x00,0x00,0x00,
	0x00,0x00,0x0f,0x80,0x00,0xfc,0x1c,0x0f,0x8d,0xe7,0xcf,0xe0,0xc0,0x00,0x00,0x00,
	0x00,0x00,0x1f,0x00,0x00,0x30,0x38,0x07,0x01,0xdf,0xe7,0x00,0xc0,0x00,0x00,0x00,
	0x00,0x00,0x3c,0x00,0x00,0x00,0x38,0x00,0x00,0x12,0x20,0x04,0x00,0x00,0x00,0x00,
	0x00,0x00,0x20,0x00,0x00,0x00,0x38,0x00,0x00,0x00,0x20,0x40,0x00,0x20,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x04,0x2a,0x49,0x8a,0x60,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x08,0x4c,0x5a,0x5e,0xa0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0xc0,0x00,0x00,0x08,0x99,0x52,0xfd,0xc0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0xc0,0x00,0x00,0x0f,0x0c,0xdb,0x56,0xc0,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

int main() {
	oled.setup();

	oled.clear();
	oled.drawBitmap(0, 0, logo_bmp, 128, 32);

	while (1) {
		
	}
}